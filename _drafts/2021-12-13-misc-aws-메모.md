---
layout: post
date: 2021-12-13 22:05:37 +0900
title: '[misc] AWS 메모'
categories:
  - misc
tags:
  - misc
  - aws
---

* Kramdown table of contents
{:toc .toc}

#### 참고한 문서

- [somewhere](somewhere)

## Auto Scaling 오토 스케일링

### 주의 사항

AWS 인스턴스의 기본 변수가 아닌 값을 유일값으로 사용하는 환경을 구성하면 안됨.

뭔 소리냐면 예를 들어 아파치 하나에 톰캣 여러개를 붙이고, 톰캣이 기동되는 인스턴스가 오토 스케일링으로 구성된 환경은 아파치-톰캣 통신에 필요한 AJP 포트번호가 오토 스케일링으로 늘어난 인스턴스에서 중복되니 잘못된 구성이다.

이 경우엔 EC2 인스턴스 하나에 아파치-톰캣을 짝으로(한 서버에 둘 다 넣는다는 말) 구성하는게 오토 스케일링을 위한 적절한 구성이라고 볼 수 있다.

## AWS와 UFW

AWS에는 보안 그룹 설정이 따로 있고 여기서 인/아웃바운드 규칙을 설정할 수 있기 때문에 UFW(리눅스의 방화벽 시스템)를 따로 설정하지 않아도 된다.

여담으로 IAM<sup>Identity and Access Management</sup>는 방화벽과 관련 없고 계정 컨트롤 같음.

## VPC

ㅇㅎ

## private 서브넷

VPC로 묶인 서버들의 가상 내부 통신망정도?

## 사설 VPN서버에 DNS를

> 개발팀이 VPN을 통해서만 젠킨스, 테스트 서버 등(이하 대상 서버들)에 접근할 수 있도록 제한하는 네트워크를 구성할 일이 있었음.

젠킨스, 깃 사설 서버, 테스트 서버 등(이하 대상 서버) 개발에 필요한 서버들을 외부로부터의 접근을 제한해야 할 일이 있었음. 인가된 내부 인원인 개발자나 테스터한테는 허용해야 하니까 사설 VPN 서버를 구축하기로 함. 그리고 대상 서버들은 외부 접근이 불가능하며 AWS의 private 서브넷을 통해서만 접근이 가능하도록 만들어야 함. 즉, 작업자 PC에서 VPN 서버로, VPN에서 대상 서버들로 통신하는 환경이 필요함. (이거시터널링인가?)

VPN을 구축할 서버(이하 VPN 서버)는 private 서브넷에 있으면서 public 서브넷에도 있어서 공인 IP가 부여된 상태. 우선 VPN 서버가 될 EC2 인스턴스에 OpenVPN으로 VPN 환경 구성함. 이 때 OpenVPN 설정 중 DNS는 VPN 서버 자신의 IP로 잡음(루프백 IP로 해도 될지 몰라). 왜냐면 같은 서버가 DNS 서버 역할도 할 꺼니께.

DNS 서버는 BIND9을 설치해서 함. OpenVPN 설정 중 DNS 부분 빼고는 크게 어려운 게 없었음.

OpenVPN 설치는 [여기](https://dejavuqa.tistory.com/243?category=299614), BIND9 설치는 [여기](https://lindarex.github.io/bind9/ubuntu-bind9-setting/)를 참고함.

끗.
